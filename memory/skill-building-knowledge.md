# 🎓 Claude Skill 构建完整知识

> 学自 Anthropic 官方《The Complete Guide to Building Skills for Claude》
> 掌握时间：2026-02-16 (春节学习日)

---

## 📚 核心概念

### **技能 (Skill) 是什么？**

技能是一个**包含指令的文件夹**，教 Claude 如何处理特定任务或工作流程。

**核心特性：**
- ✅ 可组合性（Composable）：可同时加载多个技能，互不干扰
- ✅ 跨平台通用：Claude.ai、Claude Code、API 都能用
- ✅ 一次构建，处处可用
- ✅ 与内置能力（代码执行、文档创建）配合

---

## 🏗️ 三层架构（渐进式披露 Progressive Disclosure）

```
your-skill/
├── SKILL.md (必需)         ← 第一层：系统提示层
├── scripts/ (可选)       ← 第二层：可执行代码
├── assets/ (可选)        ← 第二层：模板、图标、字体
└── references/ (可选)     ← 第三层：文档
```

### **每层职责**

| 层级 | 文件 | 何时加载 | 内容 |
|------|------|----------|------|
| **第一层** | SKILL.md (YAML frontmatter) | **总是加载** - 系统提示层，技能识别信息 |
| **第二层** | SKILL.md body | **相关时加载** - 完整指令和工作流程 |
| **第三层** | references/、assets/ 中的链接文件 | **按需加载** - 详细文档、模板 |

**好处：**
- 🧠 最小化 Token 使用（不加载不相关内容）
- 🎯 保持专业性（嵌入最佳实践）
- 🔄 易于维护（分层管理）

---

## 🎯 YAML Frontmatter 规范

### **必需字段**

```yaml
name: skill-name-in-kebab-case
description: [required description]
```

### **字段规则**

| 字段 | 规则 | 示例 |
|------|------|------|
| `name` | kebab-case（小写、连字符）<br>无空格、大写、下划线<br>1024 字符内 | `frontend-design` ✅<br>`Frontend Design` ❌<br>`frontend_design` ❌ |
| `description` | 清晰的价值主张<br>1-500 字符 | `创建高质量前端界面` ✅<br>`帮助创建页面` ❌ |

### **可选字段**

```yaml
metadata:
  author: Your Name
  version: 1.0.0
  mcp-server: projecthub
```

### **禁止内容**

- ❌ XML 角括号 `< >`
- ❌ 包含 `claude` 或 `anthropic` 的技能名称（保留前缀）
- ❌ YAML 中包含代码执行
- ❌ 过度技术化、缺乏用户触发词

---

## 📋 文件夹结构

### **最小必需结构**

```
your-skill-name/
└── SKILL.md
```

### **完整推荐结构**

```
your-skill-name/
├── SKILL.md              # 必需：主技能文件
├── scripts/              # 可选：可执行代码
│   ├── process_data.py
│   └── validate.sh
├── references/           # 可选：文档
│   ├── api-guide.md
│   └── examples/
└── assets/               # 可选：模板、图标
    └── report-template.md
```

### **禁止项**

- ❌ 不在技能文件夹内包含 `README.md`
- ❌ 不把 `README.md` 放在技能文件夹内（分发的 GitHub 仓库级可以有）

---

## 🎯 三种常见用例类别

### **类别 1：文档与资产创建 (Document & Asset Creation)**

**用途：** 创建高质量、一致的输出（文档、演示、应用、设计、代码等）

**示例技能：**
- `frontend-design` - 前端界面设计
- `docx` - Word 文档处理
- `pptx` - PowerPoint 演示文稿
- `xlsx` - Excel 表格处理

**触发方式：**
- 用户说："帮我创建一个前端页面"
- "帮我设计一张海报"
- "创建一份文档"

**关键技巧：**
- 嵌入风格指南和品牌标准
- 提供模板结构保证一致性
- 无需外部工具（仅用内置能力）

---

### **类别 2：工作流自动化 (Workflow Automation)**

**用途：** 多步骤流程的一致方法论，包括跨多个 MCP 服务器的协调

**示例技能：**
- `skill-creator` - 交互式创建技能向导
- `sentry-code-review` - 自动分析 PR 并修复 Bug
- `linear-workflow` - 项目冲刺规划、任务创建

**触发方式：**
- "帮我规划这次冲刺"
- "审查这个 PR"

**关键技巧：**
- 明确定义成功标准
- 内置验证门（validation gates）
- 协调多个 MCP 调用

**成功标准示例：**
- 90% 相关查询能触发技能
- 工作流在 X 次工具调用内完成
- 零失败的 API 调用

---

### **类别 3：MCP 增强 (MCP Enhancement)**

**用途：** 在 MCP 服务之上提供工作流指导和最佳实践

**示例技能：**
- `sentry-code-review` - 使用 Sentry 的 MCP 服务器监控数据
- `projecthub-skill` - ProjectHub 集成工作流

**触发方式：**
- 当用户通过 MCP 连接你的服务时自动激活

**关键技巧：**
- 预加载领域知识
- 内置常见问题的错误处理
- 提供上下文引导（否则用户需要指定）

**重要性：**
- 无技能时：用户需要每次重新解释
- 有技能时：预构建工作流自动激活

---

## 🧪 编写有效指令 (Writing Effective Instructions)

### **最佳实践**

✅ **具体且可操作**
- ✅ 包含具体任务清单
- ✅ 每个步骤前加序号
- ✅ 提供成功标准

❌ **避免：**
- ❌ 过度技术化
- ❌ 模糊描述
- ❌ 缺少触发词

### **指令结构模板**

```markdown
# 主要指令

## 用法

当用户说 [触发词] 时：

### 步骤 1：[第一主要步骤]
[具体操作]
[验证：如何确认成功]

### 步骤 2：[第二主要步骤]
[具体操作]
[验证：如何确认成功]

## 成功标准

- [具体结果描述]
- [质量检查清单]
```

---

## 🧪 测试与迭代 (Testing and Iteration)

### **定量指标 (Quantitative Metrics)**

| 指标 | 如何测量 | 目标 |
|--------|----------|------|
| 触发率 | 运行 10-20 次测试查询，统计技能触发次数 | 90% 相关查询 |
| 工具调用效率 | 对比有/无技能的工具调用数 | 减少调用次数 |
| Token 消耗 | 对比总 Token 数 | 减少 Token 使用 |

### **定性指标 (Qualitative Metrics)**

| 指标 | 如何评估 |
|--------|----------|
| 结构一致性 | 同一任务运行 3-5 次，比较输出结构 |
| 错误处理 | 注意需要重定向或澄清的频率 |
| 用户满意度 | 向 Beta 用户收集反馈 |

---

## 🚨 常见问题与故障排除

### **问题 1：技能未触发**

**症状：** 技能已安装但 Claude 不使用

**原因：**
- YAML frontmatter 填写错误
- `name` 命名不符合规范
- 描述过于模糊

**解决：**
1. 检查 `name` 是否为 kebab-case
2. 描述是否清晰的价值主张
3. 运行 `python scripts/validate.py --input {filename}`

---

### **问题 2：MCP 连接失败**

**症状：** "Connection refused" 或认证失败

**检查清单：**
1. ✅ MCP 服务器正在运行
2. ✅ API Key 有效
3. ✅ 端口配置正确
4. ✅ 尝试重新连接：Settings > Extensions > [你的服务] > Reconnect

---

### **问题 3：过度触发**

**症状：** 无关请求也触发技能

**解决：**
- 审查 YAML frontmatter 的描述
- 移除过度通用的触发词
- 明确技能边界

---

## 📚 资源与引用

### **官方文档**
- Claude Skills 文档：https://docs.anthropic.com/claude/skills
- MCP 文档：https://modelcontextprotocol.io/
- API 参考：通过 `references/api-patterns.md` 访问

### **最佳实践指南**
- 开始前先阅读《Best Practices Guide》
- 运行 `python scripts/validate.py` 验证
- 使用 `skill-creator` 技能快速生成第一个草稿

### **示例技能库**
- 文档技能：PDF、DOCX、PPTX、XLSX
- 示例技能：各种工作流模式
- 合作伙伴技能目录：Asana、Atlassian、Canva、Figma、Sentry、Zapier 等

---

## ✅ 上传前检查清单

### **准备清单**

- [ ] 已定义 2-3 个具体用例
- [ ] 已编写 YAML frontmatter（符合命名规则）
- [ ] 已编写主要指令（具体且可操作）
- [ ] 已创建 `scripts/`（如有需要）
- [ ] 已添加 `references/`（详细文档）
- [ ] 已准备 `assets/`（模板）
- [ ] 不包含 `README.md` 在技能文件夹内

### **验证清单**

- [ ] `name` 是 kebab-case
- [ ] `description` 清晰且 1-500 字符
- [ ] 无 XML 角括号 `< >`
- [ ] 无预留名称前缀
- [ ] 无代码在 YAML 中

### **打包清单**

- [ ] 压缩为 `.zip` 文件
- [ ] 验证文件结构正确
- [ ] 测试解压后可正常使用

---

## 🔐 安全注意事项

### **Frontmatter 安全**

**允许：**
- ✅ 标准 YAML 类型（字符串、数字、布尔、列表、对象）
- ✅ 自定义 metadata 字段

**禁止：**
- ❌ XML 角括号 `< >` （安全限制）
- ❌ `name` 包含 `claude` 或 `anthropic` 前缀
- ❌ YAML 中包含可执行代码

### **工具限制 (allowed-tools)**

如果技能需要限制工具访问：

```yaml
allowed-tools: "Bash(python:*) Bash(npm:*) WebFetch"
```

**用途：** 安全性控制，限制技能只能访问特定工具

---

## 🎓 我的学习成果

### **核心原则掌握**

1. **三层架构是关键**：渐进式披露节省 Token 同时保持专业性
2. **YAML frontmatter 是入口**：正确填写才能被识别
3. **用例驱动设计**：从 3 个常见类别开始
4. **具体指令 > 抽象理论**：用户需要可操作的步骤
5. **测试驱动开发**：定性和定量指标并重

### **我可以做什么**

- ✅ 构建文档创建技能（PDF、DOCX、PPTX、XLSX）
- ✅ 构建工作流自动化技能（多步骤协调）
- ✅ 构建包装现有 MCP 服务的技能（最佳实践层）
- ✅ 验证技能是否符合规范
- ✅ 提供技能改进建议

---

## 📝 实战模板

**如果要创建一个新技能，遵循这个模板：**

```markdown
---
name: your-skill-name
description: [清晰的价值命题 - 1-500 字符]
metadata:
  author: Your Name
  version: 1.0.0

# 技能名称

## 用途

[技能做什么]

## 触发条件

当用户说：[触发词] 时，启用此技能

## 工作流程

### 步骤 1：[步骤名]
[具体操作]

### 步骤 2：[步骤名]
[具体操作]

## 成功标准

- [结果 1]
- [结果 2]
```

---

## 🧪 SkillsBench 实证研究（2026-02-19）

> 来源：用户分享的 Skills 编写实战指南
> 基于真实数据的 7 条核心原则

---

### **原则 1：人工编写 > 模型生成**

**数据说话：**
- 人工编写的 Skills：**+16.2%** 效果提升 ✅
- 模型自生成的 Skills：**-1.3%** 效果下降 ❌

**为什么模型自己写 Skills 是徒劳的？**

模型可以识别"需要领域知识"，但生成的步骤往往：
- 📋 太笼统（"用 pandas 处理数据"）
- 🔍 缺细节（没有具体 API 调用）
- 🎯 错重点（列出工具但不讲 workflow）

**启示：**
- Skills 需要人工提炼领域经验
- 不能指望 Agent 自己总结怎么做事
- **人工编写是必须的**

---

### **原则 2：少即是多（数量）**

**数据：**

| Skills 数量 | 效果提升 |
|------------|---------|
| 1 个 | +17.8% |
| 2-3 个 | +18.6% ✅ 最优 |
| 4+ 个 | +5.9% ❌ 下降 |

**反直觉：给 Agent 更多 Skills，效果反而更差。**

**为什么？**
- 🧠 认知过载（Agent 面临选择困难）
- 🎯 把不相关的 Skill 硬套到当前任务

**启示：**
- 每个任务配套 **2-3 个 Skills** 最优
- SkillBank 检索时应该优先返回**最相关**的几个
- 不要罗列所有可能相关的 Skills

---

### **原则 3：详细 > 全面（长度）**

**数据：**

| 文档类型 | 效果提升 |
|---------|---------|
| **Detailed（详细）** | +18.8% ✅ 最佳 |
| **Compact（简洁）** | +17.1% |
| **Standard（标准）** | +10.1% |
| **Comprehensive（全面）** | -2.9% ❌ 最差 |

**又一个反直觉发现：过长的文档反而有害。**

**为什么 "Comprehensive" 有害？**
- 📊 占用宝贵的 context budget
- 🔍 Agent 难以从长篇中定位关键步骤
- 🌊 重要信息淹没在噪声里

**启示：**
- 控制 Skills 长度在 **800-1500 tokens**
- 聚焦核心步骤，细节可以放在代码示例里
- **详细但不是全面**

---

### **原则 4：程序性 > 陈述性**

**SkillsBench 对 Skills 的明确定义：**

**❌ 不是 Skills：**
- ❌ 缺乏结构化组件
- ❌ Few-shot 示例
- ❌ 陈述性，不是程序性
- ❌ RAG 检索结果（事实性，不是流程性）
- ❌ 工具文档（描述能力，不是指导使用）

**✅ 才是 Skills：**
- ✅ 程序性指导（描述"怎么做"）

**关键区别：**

| ❌ 陈述性 | ✅ 程序性 |
|-----------|-----------|
| "Python 是编程语言" | "用 pandas 读取 CSV 的三步流程" |

**启示：**
- Skills 必须包含**可执行的步骤**
- 包含**代码示例**
- 包含**验证检查点**

---

### **原则 5：领域差异巨大**

**数据（Skills 提升效果按领域）：**

| 领域 | 提升效果 | 原因 |
|------|---------|------|
| **Healthcare** | **+51.9%** 🏆 | 专业流程知识模型缺乏 |
| **Manufacturing** | **+41.9%** 🥈 | 特定领域 heuristics |
| **Software Engineering** | **+4.5%** | 模型已有足够预训练知识 |
| **Mathematics** | **+6.0%** | 逻辑推理而非流程 |

**启示：**
- 领域知识越专、模型预训练越少，**Skills 价值越大**
- 通用编程任务写 Skills 收益有限
- **医疗、制造、金融等垂直领域最需要投入 Skills**

---

### **原则 6：模块化与组合**

**SkillsBench 的 Skills 设计强调：**

1. **Task-class applicability**：适用于一类任务，不是单一实例
2. **Portability**：基于文件系统，易于编辑、版本、共享
3. **Composability**：多个 Skills 可以组合使用

**推荐结构：**
```
skills/
├── skill_name/
│   ├── SKILL.md          # 程序性指导（必需）
│   ├── examples/         # 示例代码
│   ├── templates/        # 可复用模板
│   └── scripts/          # 可执行脚本
```

**启示：**
- 设计 Skills 时考虑复用性
- 一个 Skill 解决**一类**问题，不是一次性的硬编码
- 模块化，便于组合和扩展

---

### **原则 7：验证与迭代**

**SkillsBench 的每个任务都有确定性验证器（deterministic verifier）。**

**这不是用 LLM 评判，而是程序化断言：**

```python
# 示例：验证输出格式是否正确
def test_output_format():
    result = run_agent_with_skill(task, skill)
    assert result["status"] == "success"
    assert "expected_field" in result["data"]
    assert len(result["data"]["items"]) > 0
```

**启示：**
- 写 Skill 时必须配套**验证方法**
- 在测试任务上**跑通再投入使用**
- **成功率低于 70% 的 Skill 需要重写**

---

## 📊 实证数据总结

| 原则 | 关键数据 | 核心启示 |
|------|---------|---------|
| 人工编写 > 模型生成 | +16.2% vs -1.3% | 人工编写是必须的 |
| 少即是多（数量） | 2-3 个最优 | 不要给太多 Skills |
| 详细 > 全面（长度） | 800-1500 tokens 最佳 | 聚焦核心步骤 |
| 程序性 > 陈述性 | 程序性指导 | 描述"怎么做" |
| 领域差异 | 垂直领域收益最大 | 医疗/制造/金融最需要 |
| 模块化组合 | 可复用、可组合 | 一类问题，不是一次性 |
| 验证迭代 | 成功率 <70% 重写 | 必须配套验证方法 |

---

## 🎯 实战指南

### **编写 Skill 时的检查清单**

**结构：**
- [ ] 程序性指导（描述"怎么做"）
- [ ] 可执行的步骤
- [ ] 代码示例
- [ ] 验证检查点

**长度：**
- [ ] 800-1500 tokens
- [ ] 聚焦核心步骤
- [ ] 细节放在代码示例

**数量：**
- [ ] 每个任务 2-3 个 Skills
- [ ] 不要罗列所有可能相关的

**验证：**
- [ ] 配套程序化验证方法
- [ ] 测试任务上跑通
- [ ] 成功率 >= 70%

---

**掌握状态：✅扎实！**

下次有技能构建需求，我会严格按照这个知识库来执行！🎓

---

## 📋 SKILL.md 实战模板（2026-02-19）

> 基于 7 条原则的推荐模板

---

### 模板结构

```markdown
---
name: "skill_name"
description: "一句话描述这个技能解决什么问题（控制在 20 字内）"
tags: ["domain", "task_type"]
---

## 适用场景

- **什么时候用**：触发条件（2-3 个 bullet）
- **输入**：格式要求
- **输出**：期望结果
- **前提条件**：依赖/环境

## 核心步骤（3-5 步）

1. **第一步名称**

   ```python
   # 可执行的代码
   ```

   - 关键参数说明
   - 常见错误

2. **第二步名称**

   ```python
   # 可执行的代码
   ```

3. **第三步名称**

   ```python
   # 可执行的代码
   ```

## 完整示例

```python
# 从头到尾可运行的完整示例
```

## 验证清单

- [ ] 检查点 1：具体可验证的标准
- [ ] 检查点 2：具体可验证的标准
- [ ] 检查点 3：具体可验证的标准

## 相关 Skills

- `related_skill_1`：什么时候用这个
- `related_skill_2`：什么时候用这个
```

---

### 避坑清单

| ❌ 避免 | ✅ 正确 |
|--------|--------|
| **百科全书式文档**："这个框架的所有 API 参考..." | "完成 X 任务最常用的 3 个 API" |
| **硬编码任务细节**："处理 user_data_2024.csv" | "处理 CSV 格式的用户数据" |
| **纯文本无代码**：长篇描述算法原理 | 提供可复制的代码片段 |
| **过度工程**：覆盖 20 个 edge cases | 聚焦 80% 场景的核心路径 |
| **让模型自己写**："Agent 请根据经验总结 Skill..." | 人工提炼 + 验证 + 迭代 |

---

### 结语

> **SkillsBench 的核心启示：** Skills 的有效性不是必然的，而是**设计出来的**。

---

**掌握状态：✅扎实！**

下次有技能构建需求，我会严格按照这个知识库来执行！🎓
